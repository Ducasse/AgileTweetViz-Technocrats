Object subclass: #RegionWiseSentimentAnalyzer	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 15:39'!getLocationCoOrdinates:regionalSentiments|reader locationDict sentimentsDict size i sentiment region keys key location latitude longitude|reader:=CSVReader new.locationDict:=reader parseCSV.sentimentsDict:= Dictionary new.size:= regionalSentiments size.i:=1.[ i<=size ]whileTrue:[	sentiment:=regionalSentiments at:i.   region:= sentiment region.   sentimentsDict at: region put:sentiment.    i:=i+1.  ].keys:=sentimentsDict keys.size:= keys size.i:=1.[ i<=size ]whileTrue:[ key:= keys at:i. sentiment:=sentimentsDict at: key. location:=nil. location:=locationDict at:key ifPresent:[locationDict at:key].	 (location=nil)ifFalse:[  	latitude:=location latitude.	longitude:=location longitude.	sentiment latitude:latitude.	sentiment longitude:longitude.  ]. i:=i+1. ].^ sentimentsDict.! !!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 15:16'!getSentiments:filePath |tweetsParser tweetsArray i size tweet sentiment regionalSentiment positiveTweets negativeTweets neutralTweets totalTweets percentPositive percentNegative percentNeutral netSentiment|tweetsParser:=TweetsParsor new.tweetsArray:= tweetsParser parseToJSON:filePath.i:=1.regionalSentiment:=RegionalSentiment new.positiveTweets:=0.negativeTweets:=0.neutralTweets:=0.size:= tweetsArray size.[ i<=size ]whileTrue:[tweet:=tweetsArray at: i.sentiment:=tweet sentiment.(sentiment='positive')ifTrue:[ positiveTweets:=positiveTweets+1.].(sentiment='negative')ifTrue:[negativeTweets:=negativeTweets+1.	].(sentiment='neutral')ifTrue:[neutralTweets:=neutralTweets+1.].i:=i+1.].totalTweets:=positiveTweets+negativeTweets+neutralTweets.percentPositive:=0.percentNegative:=0.percentNeutral:=0.(totalTweets>0)ifTrue:[percentPositive:=((positiveTweets*100.0)/totalTweets).percentNegative:=((negativeTweets*100.0)/totalTweets).percentNeutral:=(100.0-(percentPositive+percentNegative)).].regionalSentiment noOfPositiveTweets:percentPositive.regionalSentiment noOfNegativeTweets:percentNegative.regionalSentiment noOfNeutralTweets:percentNeutral.netSentiment:=percentPositive-percentNegative.regionalSentiment netSentiment:netSentiment.^ regionalSentiment.! !!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 17:00'!getSentimentsDict: directoryName| working dirPath children size i sentiments count file path name nameparts timezone sentiment netSentiment newSentimentsArray j sentimentsDict   tempParts temp |working := FileSystem disk workingDirectory.dirPath:=working/directoryName.children:=dirPath children.size:=children size.i:=1.sentiments:=Array new:size.count:=0.[ i<=size ]whileTrue:[file:=children at: i.path:=file path.name:= file basename.tempParts:=(name subStrings:('.')) .temp:=tempParts at:1.nameparts:= (temp subStrings:('_')) . timezone:= nameparts at:3.sentiment:= self getSentiments:path.	sentiment region:timezone.sentiments at:i put: sentiment.netSentiment:= sentiment netSentiment.(netSentiment<0)ifTrue:[netSentiment:=netSentiment*(-1)].(netSentiment< 50.0)ifTrue:[ count:=count+1.].i:=i+1.].newSentimentsArray:=Array new:count.i:=1.j:=1.[ i<=size ]whileTrue:[sentiment:= sentiments at:i.netSentiment:= sentiment netSentiment.(netSentiment<0)ifTrue:[netSentiment:=netSentiment*(-1)].(netSentiment<50) ifTrue:[newSentimentsArray at: j put: sentiment.	j:=j+1.].	i:=i+1.].newSentimentsArray.sentimentsDict:=self getLocationCoOrdinates:newSentimentsArray.^sentimentsDict.! !Object subclass: #Analysis	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!Analysis methodsFor: 'as yet unclassified' stamp: 'TanmayPatil 11/13/2015 16:42'!initSentimentData	| dataSet d1 d2 d3     |	dataSet := OrderedCollection new.	d1 := OrderedCollection new.	d1 add: 'positive'.	d1 add: 0.	dataSet add: d1.	d2 := OrderedCollection new.	d2 add: 'negative'.	d2 add: 0.	dataSet add: d2.	d3 := OrderedCollection new.	d3 add: 'neutral'.	d3 add: 0.	dataSet add: d3.	^ dataSet! !!Analysis methodsFor: 'as yet unclassified' stamp: 'TanmayPatil 11/13/2015 16:42'!initialize	super initialize! !!Analysis methodsFor: 'as yet unclassified' stamp: 'TanmayPatil 11/13/2015 16:51'!classify	| tweets tp dataSet  row count b ds sentiment |	tweets := OrderedCollection new.	tp := TweetsParsor new.	tweets := tp parseToJSON.		dataSet := self initSentimentData .		tweets do: [ :tweet |		tweet sentiment = -1 ifFalse: [			sentiment := tweet sentiment.				row := (dataSet select: [ :i |				(i at: 1) = sentiment			]) at: 1.			count := row at: 2.			row removeAt: 2.			row add: (count + 1).		].	].		b := RTGrapher new.	ds := RTStackedDataSet new.	ds points: dataSet.	ds y: #second.	ds barShape width: 40.	ds histogramWithBarTitle: #first rotation: -45.	b add: ds.	b axisX noLabel; noTick.	b build.	^ b view! !Object subclass: #RegionalSentiment	instanceVariableNames: 'region noOfPositiveTweets noOfNegativeTweets noOfNeutralTweets netSentiment latitude longitude'	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:38'!netSentiment^netSentiment.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfNeutralTweets:numnoOfNeutralTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:55'!latitude^ latitude.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:59'!initializeregion:=nil.noOfPositiveTweets:=nil.noOfNegativeTweets:=nil.noOfNeutralTweets:=nil.netSentiment:=nil.latitude:=nil.longitude:=nil.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfNegativeTweets:numnoOfNegativeTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:56'!longitude: longlongitude:=long.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:37'!getSentiments:filePath |tweetsParser tweetsArray i size tweet sentiment regionalSentiment positiveTweets negativeTweets neutralTweets totalTweets percentPositive percentNegative percentNeutral netSentiment|tweetsParser:=TweetsParsor new.tweetsArray:= tweetsParser parseToJSON:filePath.i:=1.regionalSentiment:=RegionalSentiment new.positiveTweets:=0.negativeTweets:=0.neutralTweets:=0.size:= tweetsArray size.[ i<=size ]whileTrue:[tweet:=tweetsArray at i.sentiment:=tweet sentiment.[sentiment:='positive']ifTrue:[ positiveTweets:=positiveTweets+1.].[sentiment:='negative']ifTrue:[negativeTweets:=negativeTweets+1.	].[ sentiment:='neutral']ifTrue:[neutralTweets:=neutralTweets+1.].i:=i+1.].totalTweets:=positiveTweets+negativeTweets+neutralTweets.percentPositive:=0.percentNegative:=0.percentNeutral:=0.percentPositive:=(positiveTweets*100.0)/totalTweets.percentNegative=(negativeTweets*100.0)/totalTweets.percentNeutral=100.0-(percentPositive+percentNegative).regionalSentiment noOfPositiveTweets:percentPositive.regionalSentiment noOfNegativeTweets:percentNegative.regionalSentiment noOfNeutralTweets:percentNeutral.netSentiment:=percentPositive-percentNegative.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:47'!noOfPositiveTweets^ noOfPositiveTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:47'!noOfNegativeTweets^ noOfNegativeTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:56'!longitude^ longitude.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:46'!region: regionValueregion:=regionValue.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:38'!netSentiment: netnetSentiment:=net.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfPositiveTweets:numnoOfPositiveTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:48'!noOfNeutralTweets^ noOfNeutralTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:46'!region^ region.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:55'!latitude:latlatitude:=lat.! !