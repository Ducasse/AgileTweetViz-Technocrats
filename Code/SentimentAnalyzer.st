TestCase subclass: #AnalysisTest	instanceVariableNames: 'dataSet'	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!AnalysisTest methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:55'!testInitSentimentData	| size a this  |		this := self.		a := Analysis new.	dataSet := a initSentimentData.	size := dataSet size.	this assert: (size = 3).		dataSet do: [ :el | this assert: ( el size = 4)  ].	dataSet do: [ :el | this assert: ( el includes: 0)  ].	dataSet do: [ :el | this assert: ( ( ( el includes: 'positive') or: (el includes: 'negative') ) or: (el includes: 'neutral') ) ].			! !!AnalysisTest methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:55'!testInitComparisonData	| size a this  |		this := self.		a := Analysis new.	dataSet := a initComparisonData.	size := dataSet size.	this assert: (size = 3).		dataSet do: [ :el | this assert: ( el size = 7)  ].	dataSet do: [ :el | this assert: ( el includes: 0)  ].	dataSet do: [ :el | this assert: ( ( ( el includes: 'positive') or: (el includes: 'negative') ) or: (el includes: 'neutral') ) ].			! !Object subclass: #RegionWiseSentimentAnalyzer	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 15:39'!getLocationCoOrdinates:regionalSentiments|reader locationDict sentimentsDict size i sentiment region keys key location latitude longitude|reader:=CSVReader new.locationDict:=reader parseCSV.sentimentsDict:= Dictionary new.size:= regionalSentiments size.i:=1.[ i<=size ]whileTrue:[	sentiment:=regionalSentiments at:i.   region:= sentiment region.   sentimentsDict at: region put:sentiment.    i:=i+1.  ].keys:=sentimentsDict keys.size:= keys size.i:=1.[ i<=size ]whileTrue:[ key:= keys at:i. sentiment:=sentimentsDict at: key. location:=nil. location:=locationDict at:key ifPresent:[locationDict at:key].	 (location=nil)ifFalse:[  	latitude:=location latitude.	longitude:=location longitude.	sentiment latitude:latitude.	sentiment longitude:longitude.  ]. i:=i+1. ].^ sentimentsDict.! !!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 17:00'!getSentimentsDict: directoryName| working dirPath children size i sentiments count file path name nameparts timezone sentiment netSentiment newSentimentsArray j sentimentsDict   tempParts temp |working := FileSystem disk workingDirectory.dirPath:=working/directoryName.children:=dirPath children.size:=children size.i:=1.sentiments:=Array new:size.count:=0.[ i<=size ]whileTrue:[file:=children at: i.path:=file path.name:= file basename.tempParts:=(name subStrings:('.')) .temp:=tempParts at:1.nameparts:= (temp subStrings:('_')) . timezone:= nameparts at:3.sentiment:= self getSentiments:path.	sentiment region:timezone.sentiments at:i put: sentiment.netSentiment:= sentiment netSentiment.(netSentiment<0)ifTrue:[netSentiment:=netSentiment*(-1)].(netSentiment< 50.0)ifTrue:[ count:=count+1.].i:=i+1.].newSentimentsArray:=Array new:count.i:=1.j:=1.[ i<=size ]whileTrue:[sentiment:= sentiments at:i.netSentiment:= sentiment netSentiment.(netSentiment<0)ifTrue:[netSentiment:=netSentiment*(-1)].(netSentiment<50) ifTrue:[newSentimentsArray at: j put: sentiment.	j:=j+1.].	i:=i+1.].newSentimentsArray.sentimentsDict:=self getLocationCoOrdinates:newSentimentsArray.^sentimentsDict.! !!RegionWiseSentimentAnalyzer methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/20/2015 15:16'!getSentiments:filePath |tweetsParser tweetsArray i size tweet sentiment regionalSentiment positiveTweets negativeTweets neutralTweets totalTweets percentPositive percentNegative percentNeutral netSentiment|tweetsParser:=TweetsParsor new.tweetsArray:= tweetsParser parseToJSON:filePath.i:=1.regionalSentiment:=RegionalSentiment new.positiveTweets:=0.negativeTweets:=0.neutralTweets:=0.size:= tweetsArray size.[ i<=size ]whileTrue:[tweet:=tweetsArray at: i.sentiment:=tweet sentiment.(sentiment='positive')ifTrue:[ positiveTweets:=positiveTweets+1.].(sentiment='negative')ifTrue:[negativeTweets:=negativeTweets+1.	].(sentiment='neutral')ifTrue:[neutralTweets:=neutralTweets+1.].i:=i+1.].totalTweets:=positiveTweets+negativeTweets+neutralTweets.percentPositive:=0.percentNegative:=0.percentNeutral:=0.(totalTweets>0)ifTrue:[percentPositive:=((positiveTweets*100.0)/totalTweets).percentNegative:=((negativeTweets*100.0)/totalTweets).percentNeutral:=(100.0-(percentPositive+percentNegative)).].regionalSentiment noOfPositiveTweets:percentPositive.regionalSentiment noOfNegativeTweets:percentNegative.regionalSentiment noOfNeutralTweets:percentNeutral.netSentiment:=percentPositive-percentNegative.regionalSentiment netSentiment:netSentiment.^ regionalSentiment.! !Object subclass: #RegionalSentiment	instanceVariableNames: 'region noOfPositiveTweets noOfNegativeTweets noOfNeutralTweets netSentiment latitude longitude'	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:38'!netSentiment^netSentiment.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:55'!latitude^ latitude.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:46'!region: regionValueregion:=regionValue.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:59'!initializeregion:=nil.noOfPositiveTweets:=nil.noOfNegativeTweets:=nil.noOfNeutralTweets:=nil.netSentiment:=nil.latitude:=nil.longitude:=nil.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfNeutralTweets:numnoOfNeutralTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:37'!getSentiments:filePath |tweetsParser tweetsArray i size tweet sentiment regionalSentiment positiveTweets negativeTweets neutralTweets totalTweets percentPositive percentNegative percentNeutral netSentiment|tweetsParser:=TweetsParsor new.tweetsArray:= tweetsParser parseToJSON:filePath.i:=1.regionalSentiment:=RegionalSentiment new.positiveTweets:=0.negativeTweets:=0.neutralTweets:=0.size:= tweetsArray size.[ i<=size ]whileTrue:[tweet:=tweetsArray at i.sentiment:=tweet sentiment.[sentiment:='positive']ifTrue:[ positiveTweets:=positiveTweets+1.].[sentiment:='negative']ifTrue:[negativeTweets:=negativeTweets+1.	].[ sentiment:='neutral']ifTrue:[neutralTweets:=neutralTweets+1.].i:=i+1.].totalTweets:=positiveTweets+negativeTweets+neutralTweets.percentPositive:=0.percentNegative:=0.percentNeutral:=0.percentPositive:=(positiveTweets*100.0)/totalTweets.percentNegative=(negativeTweets*100.0)/totalTweets.percentNeutral=100.0-(percentPositive+percentNegative).regionalSentiment noOfPositiveTweets:percentPositive.regionalSentiment noOfNegativeTweets:percentNegative.regionalSentiment noOfNeutralTweets:percentNeutral.netSentiment:=percentPositive-percentNegative.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:56'!longitude^ longitude.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfPositiveTweets:numnoOfPositiveTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:47'!noOfNegativeTweets^ noOfNegativeTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:47'!noOfPositiveTweets^ noOfPositiveTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 16:38'!netSentiment: netnetSentiment:=net.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:49'!noOfNegativeTweets:numnoOfNegativeTweets:=num.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:46'!region^ region.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 13:48'!noOfNeutralTweets^ noOfNeutralTweets.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:56'!longitude: longlongitude:=long.! !!RegionalSentiment methodsFor: 'as yet unclassified' stamp: 'AdityaBivalkar 11/14/2015 19:55'!latitude:latlatitude:=lat.! !Object subclass: #Analysis	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SentimentAnalyzer'!!Analysis methodsFor: 'as yet unclassified' stamp: 'TanmayPatil 11/13/2015 16:42'!initialize	super initialize! !!Analysis methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:33'!initSentimentData	| dataSet d1 d2 d3     |	dataSet := OrderedCollection new.	d1 := OrderedCollection new.	d1 add: 'positive'.	d1 add: 0.	d1 add: String new.	d1 add: 0.	dataSet add: d1.	d2 := OrderedCollection new.	d2 add: 'negative'.	d2 add: 0.	d2 add: String new.	d2 add: 0.	dataSet add: d2.	d3 := OrderedCollection new.	d3 add: 'neutral'.	d3 add: 0.	d3 add: String new.	d3 add: 0.	dataSet add: d3.	^ dataSet! !!Analysis methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:36'!initComparisonData	| dataSet a1 a2 a3      |	dataSet := OrderedCollection new.	a1 := OrderedCollection new.	a1 add: 'positive'.	a1 add: 0.	a1 add: 0.	a1 add: String new.	a1 add: String new.	a1 add: 0.	a1 add: 0.	dataSet add: a1 asArray.		a2 := OrderedCollection new.	a2 add: 'negative'.	a2 add: 0.	a2 add: 0.	a2 add: String new.	a2 add: String new.	a2 add: 0.	a2 add: 0.	dataSet add: a2 asArray .		a3 := OrderedCollection new.	a3 add: 'neutral'.	a3 add: 0.	a3 add: 0.	a3 add: String new.	a3 add: String new.	a3 add: 0.	a3 add: 0.	dataSet add: a3 asArray .	^ dataSet asArray! !!Analysis methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:38'!classify	| tweets tp dataSet  row count b ds sentiment str n a |	tweets := OrderedCollection new.	tp := TweetsParsor new.	tweets := tp parseToJSON:'analyzed_tweets.json'.		dataSet := self initSentimentData .		tweets do: [ :tweet |		tweet sentiment = -1 ifFalse: [			sentiment := tweet sentiment.				row := (dataSet select: [ :i |				(i at: 1) = sentiment			]) at: 1.			count := row at: 2.			row at: 2 put: (count + 1).			str := row at: 3.			count := row at: 4.			count := count + 1.			str := str , count asString , ')', tweet text , String cr.			row at: 3 put: str. 			row at: 4 put: count.		].	].		b := RTGrapher new.	ds := RTStackedDataSet new.	ds points: dataSet.	ds y: #second.	ds interaction highlightColored: Color red.	ds interaction popup		background: Color lightBlue		group: [ :group :element |		| s  |		n := element model at: 3.		s := RTLabel new text: n.		a := OrderedCollection new.		a add: 1.		group addAll: (s elementsOn: a asArray).		RTGridLayout on: group ].	ds barShape width: 40; color: Color blue.	ds histogramWithBarTitle: #first rotation: -45.	b add: ds.	b axisX noLabel; noTick.	b build.	^ b view! !!Analysis methodsFor: 'as yet unclassified' stamp: 'MeenalKulkarni 11/22/2015 16:39'!compareBrands	| tweets_brand1 tp1 b dataSet name_of_brand1 tweets_brand2 tp2 name_of_brand2 title1 title2 sentiment row count brand1_text brand2_text   |	tweets_brand1 := OrderedCollection new.	tp1 := TweetsParsor new.	tweets_brand1 := tp1 parseToJSON: 'analyzed_tweets_#DonaldTrump.json'.	name_of_brand1 := 'Donald Trump'.		tweets_brand2 := OrderedCollection new.	tp2 := TweetsParsor new.	tweets_brand2 := tp2 parseToJSON: 'analyzed_tweets_#HillaryClinton.json'.	name_of_brand2 := 'Hillary Clinton'.		dataSet := self initComparisonData.		tweets_brand1 do: [ :tweet |		tweet sentiment = -1 ifFalse: [			sentiment := tweet sentiment.			row := (dataSet select: [ :i |				(i at: 1) = sentiment			]) at: 1.			count := row at: 2.			row at: 2 put: (count + 1).			brand1_text := row at: 4.			count := row at: 6.			brand1_text := brand1_text, (count+1) asString , ')', tweet text , String cr.			row at: 4 put: brand1_text. 			row at: 6 put: (count + 1).									].	].	tweets_brand2 do: [ :tweet |		tweet sentiment = -1 ifFalse: [			sentiment := tweet sentiment.			row := (dataSet select: [ :i |				(i at: 1) = sentiment			]) at: 1.			count := row at: 3.			row at: 3 put: (count + 1).			brand2_text := row at: 5.			count := row at: 7.			brand2_text := brand2_text, (count+1) asString , ')', tweet text , String cr.			row at: 5 put: brand2_text. 			row at: 7 put: (count + 1).		].	].		b := RTDoubleBarBuilder new.	b pointName: [ :row1 | row1 at: 1 ]. 	b points: dataSet.		title1 := 'GREY: ', name_of_brand1, ' (x 10)'.	title2 := 'RED: ', name_of_brand2, ' (x 10)'.	b bottomValue: [ : row2 | ((row2 at: 2) / 10) asInteger]titled: title1.	b topValue: [ :row3 | ((row3 at: 3) / 10) asInteger] titled: title2.		b build.	^ b view.! !